<!DOCTYPE html>
<html>
<head>
	<title>Static timeline with filter. Basic Example.</title>

	<link rel="stylesheet" href="../../dist/sentio.css" />

	<script src="../../src/lib/d3/d3.js" charset="utf-8"></script>
	<script src="../../dist/sentio.js" charset="utf-8"></script>

	<style>
	</style>

</head>
<body>
	<div id="chart"></div>
	<button onclick="updateData()">Update Data</button>

	<script type="text/javascript">
		var timelineDiv = d3.select('#chart');
		var timeline = sentio.timeline.line()
			.height(100)
			.width(600)
			.filter(true)
			.yExtent([0, undefined]);

		timeline.filter()
			.on('filter', function(val) { console.log({ msg: 'filter', val: val }); })
			.on('filterstart', function(val) { console.log({ msg: 'filterstart', val: val }); })
			.on('filterend', function(val) { console.log({ msg: 'filterend', val }); });

		var interval = 60000;
		var binSize = 1000;
		var hwm = Date.now();
		var model = sentio.model.bins({
			count: interval/binSize,
			size: binSize,
			lwm: hwm - interval,
			updateBin: function(bin, d) { bin[1] += d; },
			createSeed: function() { return 0; },
			getKey: function(d) { return d[0]; },
			getValue: function(d) { return d[1]; }
		});

		var data = generateData(hwm - interval, hwm);
		model.add(data);

		timeline.init(timelineDiv).data(model.bins()).redraw();

		function generateData(minTs, maxTs) {
			var data = [];
			for(var i=0; i<(maxTs - minTs)/5000; i++) {
				data.push([minTs + Math.random() * (maxTs - minTs), Math.random() * 10]);
			}
			return data;
		}

		function updateData() {
			// set the new lwm
			var oldHwm = hwm;
			hwm = Date.now();
			model.clear().lwm(hwm - interval);

			// add new data from old hwm to new hwm
			data.concat(generateData(oldHwm, hwm));

			// load the data
			model.add(data);

			timeline.redraw();
		}

	</script>

</body>
</html>

