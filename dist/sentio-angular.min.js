angular.module("sentio",[]),angular.module("sentio.realtime",[]),angular.module("sentio").directive("sentioDonutChart",["$document","$window","$timeout","$log",function(e,t,i,n){"use strict";return{restrict:"A",scope:{model:"=sentioModel",duration:"=sentioDuration",color:"=sentioColor",api:"=sentioApi",resizeWidth:"@sentioResizeWidth",resizeHeight:"@sentioResizeHeight",configureFn:"&sentioConfigureFn"},replace:!1,link:function(l,o,r,a){var u=d3.select(o[0]),s=sentio.chart.donut(),c=o[0].style.width;null!=c&&""!==c&&(c=parseFloat(c.substring(0,c.length-2)),null==c||isNaN(c)||(s.width(c),s.height(c))),s.init(u),l.$watchCollection("model",function(e,t){null==t&&null==e||(s.data(e),v())}),l.$watch("configureFn",function(e,t){null!=l.configureFn&&l.configureFn({chart:s})}),l.$watch("duration",function(e,t){null==t&&null==e||s.duration(e)}),l.$watch("colorScale",function(e,t){null==t&&null==e||s.duration(e)},!0),l.$watch("api",function(e,t){null!=l.api&&(l.api.redraw=s.redraw,l.api.resize=p)});var d,h,f=null!=r.sentioResizeWidth,w=null!=r.sentioResizeHeight,g=angular.element(t),v=function(){null!=h&&i.cancel(h),h=i(function(){s.redraw()},0)},p=function(){var t=e[0].body,i=t.style.overflow;t.style.overflow="hidden";var l=o[0],a=l.attributes.width|l.style.width|l.clientWidth,u=f?a-r.sentioResizeWidth:void 0,c=u;t.style.overflow=i;var d=s.height(),h=s.width();c!==d||u!==h?(n.debug("resize donut.chart width: "+u),n.debug("resize donut.chart height: "+c),w&&s.height(c),f&&s.width(u),s.resize(),v()):(n.debug("resize donut.chart width unchanged: "+u),n.debug("resize donut.chart height unchanged: "+c))},$=function(){void 0!==d&&i.cancel(d),d=i(p,0)};f&&(g.on("resize",$),$()),l.$on("$destroy",function(){g.off("resize",$)})}}}]),angular.module("sentio").directive("sentioMatrixChart",["$document","$window","$timeout","$log",function(e,t,i,n){"use strict";return{restrict:"A",scope:{model:"=sentioModel",configureFn:"&sentioConfigureFn"},replace:!1,link:function(e,t,n,l){var o=d3.select(t[0]),r=sentio.chart.matrix();r.init(o),e.$watch("configureFn",function(t,i){null!=e.configureFn&&e.configureFn({chart:r})}),e.$watchCollection("model",function(e,t){null==t&&null==e||(r.data(e),u())});var a,u=function(){null!=a&&i.cancel(a),a=i(function(){r.redraw()},0)};e.$on("$destroy",function(){null!=a&&i.cancel(a)})}}}]),angular.module("sentio.realtime").directive("sentioRtTimeline",["$document","$window","$timeout","$log",function(e,t,i,n){"use strict";return{restrict:"A",scope:{model:"=sentioModel",markers:"=sentioMarkers",markerHover:"=sentioMarkerHover",interval:"=sentioInterval",delay:"=sentioDelay",yExtent:"=sentioYExtent",fps:"=sentioFps",api:"=sentioApi",resizeWidth:"@sentioResizeWidth",resizeHeight:"@sentioResizeHeight",configure:"&sentioConfigureFn"},replace:!1,link:function(l,o,r,a){var u=d3.select(o[0]),s=sentio.realtime.timeline(),c=o[0].style.width;null!=c&&""!==c&&(c=parseFloat(c.substring(0,c.length-2)),null==c||isNaN(c)||s.width(c));var d=o[0].style.height;null!=d&&""!==d&&(d=parseFloat(d.substring(0,d.length-2)),null==d||isNaN(d)||s.height(d)),s.init(u).data([]).start(),null!=l.markerHover&&s.dispatch().on("markerMouseover",l.markerHover),l.$watch("configure",function(e,t){null!=l.configure&&(l.configure({timeline:s}),s.redraw())}),l.$watch("model",function(e,t){null==t&&null==e||s.data(e).redraw()}),l.$watch("markers",function(e,t){null==t&&null==e||s.markers(e).redraw()}),l.$watch("interval",function(e,t){null==t&&null==e||s.interval(e).redraw()}),l.$watch("delay",function(e,t){null==t&&null==e||s.delay(e).redraw()}),l.$watchCollection("yExtent",function(e,t){null==t&&null==e||(s.yExtent().overrideValue(e),s.redraw())}),l.$watch("fps",function(e,t){null==t&&null==e||s.fps(e).redraw()}),l.$watch("api",function(e,t){null!=l.api&&(l.api.start=s.start,l.api.stop=s.stop,l.api.restart=s.restart,l.api.redraw=s.redraw,l.api.resize=v)});var h,f=null!=r.sentioResizeWidth,w=null!=r.sentioResizeHeight,g=angular.element(t),v=function(){var t=e[0].body,i=t.style.overflow;t.style.overflow="hidden";var l=o[0],a=l.attributes.width|l.style.width|l.clientWidth,u=l.attributes.height|l.style.height|l.clientHeight,c=f?a-r.sentioResizeWidth:void 0,d=w?u-r.sentioResizeHeight:void 0;t.style.overflow=i,n.debug("resize rt.timeline height: "+d+" width: "+c),f&&s.width(c),w&&s.height(d),s.resize().redraw()},p=function(){void 0!==h&&i.cancel(h),h=i(v,200)};(f||w)&&(g.on("resize",p),p()),l.$on("$destroy",function(){g.off("resize",p)}),l.$on("$destroy",function(){s.stop()})}}}]),angular.module("sentio").directive("sentioTimeline",["$document","$window","$timeout","$log",function(e,t,i,n){"use strict";return{restrict:"A",scope:{model:"=sentioModel",markers:"=sentioMarkers",yExtent:"=sentioYExtent",xExtent:"=sentioXExtent",duration:"=sentioDuration",api:"=sentioApi",resizeWidth:"@sentioResizeWidth",resizeHeight:"@sentioResizeHeight",configureFn:"&sentioConfigureFn",filterFn:"&sentioFilterFn",filterState:"=sentioFilterState"},replace:!1,link:function(l,o,r,a){var u=d3.select(o[0]),s=sentio.timeline.line(),c=o[0].style.width;null!=c&&""!==c&&(c=parseFloat(c.substring(0,c.length-2)),null==c||isNaN(c)||s.width(c));var d=o[0].style.height;null!=d&&""!==d&&(d=parseFloat(d.substring(0,d.length-2)),null==d||isNaN(d)||s.height(d)),(null!=r.sentioFilterFn||r.sentioFilterState)&&s.filter(!0);var h=null;l.$watch("filterFn",function(e,t){s.dispatch().on("filterend",function(e){i(function(){l.filterFn({filterState:e}),l.filterState=e,h=e})})}),l.$watch("filterState",function(e,t){if(null!=e&&e!==h){if(e.length>2){if(e[0])return;e=e.slice(1,3)}s.setFilter(e)}}),s.init(u),l.$watch("configureFn",function(e,t){null!=l.configureFn&&l.configureFn({timeline:s})}),l.$watchCollection("model",function(e,t){null==t&&null==e||(s.data(e),$())}),l.$watchCollection("markers",function(e,t){null==t&&null==e||(s.markers(e),$())}),l.$watchCollection("yExtent",function(e,t){null==t&&null==e||(s.yExtent().overrideValue(e),$())}),l.$watchCollection("xExtent",function(e,t){null==t&&null==e||(s.xExtent().overrideValue(e),$())}),l.$watch("duration",function(e,t){null==t&&null==e||s.duration(e)},!0),l.$watch("api",function(e,t){null!=l.api&&(l.api.start=s.start,l.api.stop=s.stop,l.api.restart=s.restart,l.api.redraw=s.redraw,l.api.resize=m)});var f,w,g=null!=r.sentioResizeWidth,v=null!=r.sentioResizeHeight,p=angular.element(t),$=function(){null!=w&&i.cancel(w),w=i(function(){s.redraw()},0)},m=function(){var t=e[0].body,i=t.style.overflow;t.style.overflow="hidden";var l=o[0],a=l.attributes.width|l.style.width|l.clientWidth,u=l.attributes.height|l.style.height|l.clientHeight,c=g?a-r.sentioResizeWidth:void 0,d=v?u-r.sentioResizeHeight:void 0;t.style.overflow=i,n.debug("resize rt.timeline height: "+d+" width: "+c),g&&s.width(c),v&&s.height(d),s.resize(),$()},z=function(){void 0!==f&&i.cancel(f),f=i(m,200)};(g||v)&&(p.on("resize",z),z()),l.$on("$destroy",function(){p.off("resize",z)})}}}]),angular.module("sentio").directive("sentioVerticalBarChart",["$document","$window","$timeout","$log",function(e,t,i,n){"use strict";return{restrict:"A",scope:{model:"=sentioModel",widthExtent:"=sentioWidthExtent",duration:"=sentioDuration",api:"=sentioApi",resizeWidth:"@sentioResizeWidth",configureFn:"&sentioConfigureFn"},replace:!1,link:function(l,o,r,a){var u=d3.select(o[0]),s=sentio.chart.verticalBars(),c=o[0].style.width;null!=c&&""!==c&&(c=parseFloat(c.substring(0,c.length-2)),null==c||isNaN(c)||s.width(c)),s.init(u),l.$watch("configureFn",function(e,t){null!=l.configureFn&&l.configureFn({chart:s})}),l.$watchCollection("model",function(e,t){null==t&&null==e||(s.data(e),g())}),l.$watchCollection("widthExtent",function(e,t){null==t&&null==e||(s.widthExtent().overrideValue(e),g())}),l.$watch("duration",function(e,t){null==t&&null==e||s.duration(e)},!0),l.$watch("api",function(e,t){null!=l.api&&(l.api.value=s.value,l.api.label=s.label,l.api.key=s.key,l.api.dispatch=s.dispatch,l.api.redraw=s.redraw,l.api.resize=v)});var d,h,f=null!=r.sentioResizeWidth,w=angular.element(t),g=function(){null!=h&&i.cancel(h),h=i(function(){s.redraw()},0)},v=function(){var t=e[0].body,i=t.style.overflow;t.style.overflow="hidden";var l=o[0],a=l.attributes.width|l.style.width|l.clientWidth,u=f?a-r.sentioResizeWidth:void 0;t.style.overflow=i,n.debug("resize verticalBars.chart width: "+u),f&&s.width(u),s.resize(),g()},p=function(){void 0!==d&&i.cancel(d),d=i(v,200)};f&&(w.on("resize",p),p()),l.$on("$destroy",function(){w.off("resize",p)})}}}]);